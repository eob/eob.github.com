



































































































































<!doctype html>


  <meta charset="utf-8">


<title>Auto-incrementing ID Columns in Google Sheets - Edward Benson</title>

<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">

<!-- Define a description for better SEO result -->
<meta name="description" content="You too can have your very own magic ID column! One fun aspect of answering Cloudstitch support tickets is seeing what kinds of crazy cool spreadsheet-powered web apps people are dreaming up. And these support tickets often drive what new...">

<!-- Cheome Web App theme color -->
<meta name="theme-color" content="#ff00b4">

<!-- Feed URL -->
<link rel="alternate" href="/feed.xml" type="application/atom+xml">

<!-- Site icons -->

  
    

    

    
      <link rel="apple-touch-icon" href="/apple-touch-icon.png">
    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    
      <link rel="icon" href="/favicon.png" type="image/png">
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    
      <link rel="mask-icon" href="/mask-icon.svg" color="#ff00b4">
    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  
    

    

    
  


<!-- Chrome Web App manifest -->
<link rel="manifest" href="/manifest.json">

<!-- Main CSS -->
<link rel="stylesheet" href="/assets/themes/curtana/css/app.css?assets-inline">

<!-- Canonical links, avoid duplicate content problems -->
<link rel="canonical" href="http://0.0.0.0:4321/2016/12/autoincrementing-id-colums-in-google-sheets">

<!-- DNS prefetching for static files -->


<!-- browser-sync, don't remove this -->
<!-- BS_INSERT -->

<!-- Head hooks -->


<!-- Open Graph and Twitter Cards support, more info: https://dev.twitter.com/docs/cards -->
<meta property="og:type" content="article">
<meta property="og:site_name" content="Edward Benson">
<meta property="og:title" content="Auto-incrementing ID Columns in Google Sheets">
<meta property="og:url" content="http://0.0.0.0:4321/2016/12/autoincrementing-id-colums-in-google-sheets">
<meta property="og:description" content="You too can have your very own magic ID column! One fun aspect of answering Cloudstitch support tickets is seeing what kinds of crazy cool spreadsheet-powered web apps people are dreaming up. And these support tickets often drive what new...">
<meta property="og:image" content="https://cdn-images-1.medium.com/max/1600/1*jBZRb4RQnBEAFWM6ehhqNQ.png">

<meta name="twitter:card" content="summary_large_image">


  <meta name="twitter:site" content="@sparanoid">



  <meta name="twitter:creator" content="@edwardbenson">



  <meta property="article:published_time" content="2016-12-05T00:00:00-08:00">
  <meta property="article:modified_time" content="">
  <meta name="twitter:label1" value="Words">
  <meta name="twitter:data1" value="531 words">
  <meta name="twitter:label2" value="Reading time">
  <meta name="twitter:data2" value="2 mins">


<!-- Post specified styles -->
<style data-assets-inline>
  /*
    TODO: You have to speicify background color for `html` in order to make `-webkit-filter` work
    Link: https://bugs.chromium.org/p/chromium/issues/detail?id=591015
    Date: Mar 1, 2016, 5:41 PM
  */
  html {
    
  }

  body {
    

    

    
  }

  

  

  

  
  
    

  

  

  /*
    TODO: Need a better solution. I have to redefine the whole box-shadow here because no invidual box-shadow-color exists
    Date: Mar 12, 2016, 12:09 AM
  */
  

  

  

  
</style>

<!-- Main navigation with current page / categoriy highlighted -->
<nav class="navigation">
  <ul>
    
      








      
      
      <li >
        <a href="/">
          
            Writing
          
        </a>
      </li>
    
      








      
      
      <li >
        <a href="/research/">
          
            Research
          
        </a>
      </li>
    
      








      
      
      <li >
        <a href="/about/">
          
            About
          
        </a>
      </li>
    
  </ul>
</nav>

<!-- Main content wrap -->
<main class="content " role=main>
  



































































































































<!-- Post-wide custom CSS -->

  


<!-- Article wrapper, limit width -->
<article 
  
>

  <!-- Post title -->
  <header 
  style="     "
>

    <h1 class="
  
" title="Auto-incrementing ID Columns in Google Sheets" data-title="Auto-incrementing ID Columns in Google Sheets">
      
  
    
  
    Auto-incrementing ID Columns in Google Sheets<span class="dot dot--post"> </span>
  

  

    </h1>

    
      <small>
        By <span rel="author">Ted Benson</span>
        on <time datetime="2016-12-05T00:00:00-08:00">Dec 5, 2016</time>
      </small>
    

    

  </header>

  <!-- Post content -->
  <div class="post-content">
    <p><span class="figcaption_hack">You too can have your very own magic ID column!</span></p>

<p>One fun aspect of answering <a href="http://www.cloudstitch.com/">Cloudstitch</a> support
tickets is seeing what kinds of crazy cool spreadsheet-powered web apps people
are dreaming up. And these support tickets often drive what new features we cook
up. A few weeks ago I wrote about adding <a href="https://medium.com/@edwardbenson/hacking-hierarchical-joins-into-spreadsheets-rails-style-b022b1a11c3c#.o8ku81qte">Rails-style
joins</a>
to our spreadsheet data API. This post is about a related topic:
auto-incrementing ID columns.</p>

<p>Auto-incrementing IDs are the bread and butter of database tables. They’re a way
to guarantee that every single item in your database (or spreadsheet, in our
case) has a unique label that can be used to join data or refer to it elsewhere
(like in your web UI code). The problem is there’s no clean and easy way (at
least to our knowledge) to magically create such a column using just cell
formulas.</p>

<p>The good news is both Google Spreadsheets and Excel let you attach little
computer scripts to your spreadsheets to do things to the data that mere
spreadsheet formulas trip over. So here is a quick tutorial for adding auto-inc
columns in GSheets.</p>

<h4 id="step-1-add-a-google-app-script-script-to-your-spreadsheet">Step 1. Add a Google App Script script to your Spreadsheet</h4>

<p><img src="https://cdn-images-1.medium.com/max/1600/1*jBZRb4RQnBEAFWM6ehhqNQ.png" alt="" />
<span class="figcaption_hack">Adding a script to your spreadsheet</span></p>

<p>Click on the <strong>Tools **menu and then on **Script Editor</strong>. That will take you to
a little-seen code editor <em>connected to your spreadsheet data</em> that is about to
become your best friend…</p>

<h4 id="step-2-copy-and-paste-this-script-in-there">Step 2: Copy and paste this script in there</h4>

<p>This script that loops over your spreadsheet and adds an incrementing number to
each row in the portion of your spreadsheet that contains data. (The last thing
you want is your spreadsheet suddenly getting numbers filling up all the blank
rows up to 999,999,999)</p>

<p>You might need to change which column (<strong>AUTOINC_COLUMN, **zero indexed) you
want your ID in and how many header rows (</strong>HEADER_ROW_COUNT<strong>) your sheet has
(so the script doesn’t write over them. Also, if your worksheet is named
something other than **Sheet1</strong>, change it inline 7.</p>

<p><span class="figcaption_hack">Code snipped to create auto-incrementing id columns in Google Spreadsheets</span></p>

<h4 id="step-3-run-and-approve-the-script">Step 3: Run and Approve the Script</h4>

<p>Copied? Pasted? Good.</p>

<p>Now click the little play button on the toolbar to force the script to run for
the first time. What we’re really trying to do here is trigger Google’s
authorization request. Even though you created this script from inside your
spreadsheet, Google want’s to double-check that it’s allowed to see your data.</p>

<p><span class="figcaption_hack">Authorizing your Google Apps Script to run</span></p>

<h4 id="step-4-schedule-the-script-to-run-whenever-the-sheet-changes"><strong>Step 4: Schedule the script to run whenever the sheet changes</strong></h4>

<p>And here’s the final, very important step: you need to tell Google to re-execute
this script whenever anything changes. This means if you’re using the
<a href="http://cloudstitch.com/">Cloudstitch API</a> to post data to your spreadsheet, new
rows will automatically get a new ID number.</p>

<p>Click on the clock icon on the toolbar to open the scheduling dialog box, and
create a new schedule item for “On change” events to your spreadsheet.</p>

<h4 id="thats-it">That’s it!</h4>

<p>Hope this helps!</p>

<p>We love to give high fives. Please send all the cool spreadsheet-based web apps
you build to @cloudstitch on Twitter.</p>


    
    

    
  </div>

</article>


</main>

<!-- Footer section -->

  <footer class="footer">
    <ul>
      <li><a href="/">Edward Benson</a></li>
      <li><a href="http://www.twitter.com/edwardbenson" title="@edwardbenson">@edwardbenson</a></li>

      

      <li><a href="/feed.xml" title="Feed - Atom (The Atom Syndication Format)">Atom</a></li>
    </ul>
  </footer>


<!-- Theme scripts -->
<script src="/assets/themes/curtana/js/app.js?assets-inline"></script>

<!-- User scripts -->
<script src="/assets/js/user.js?assets-inline"></script>

<!-- Lightense Images -->


<!-- Service Worker  -->

  


<!-- Google Analytics -->

  


<!-- Foot hooks -->



